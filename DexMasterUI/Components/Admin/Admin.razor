@page "/admin"

<MudOverlay @bind-Visible="showLoadingArt" DarkBackground="true" ZIndex="9999" AutoClose="true">
     <MudProgressCircular Color="Color.Secondary" Indeterminate="true" />
</MudOverlay>

<MudGrid>
    <MudItem lg="2">
        <MudButton Variant="Variant.Outlined" Color="Color.Primary" @onclick="GenerateRandomUsers">
            Generate Sample Random User Data
        </MudButton>
    </MudItem>
    <MudItem lg="2">
        <MudButton Variant="Variant.Outlined" Color="Color.Secondary" @onclick="ImportInitialPokemonDataAsync">
            Import Pokemon Data
        </MudButton>
    </MudItem>
</MudGrid>


@code {

    private bool showLoadingArt;
    

    protected async override Task OnInitializedAsync()
    {

    }

    private async Task GenerateRandomUsers()
    {
        showLoadingArt = true;
        StateHasChanged();

        var fakeUsers = new Faker<User>()
            .RuleFor<string>(u => u.Username, f => f.Random.Word())
            .RuleFor<string>(u => u.FirstName, f => f.Name.FirstName())
            .RuleFor<string>(u => u.LastName, f => f.Name.LastName());

        await userData.CreateMultipleUsersAsync(fakeUsers.Generate(15));

        showLoadingArt = false;
        StateHasChanged();
    }

    private async Task ImportInitialPokemonDataAsync()
    {
        showLoadingArt = true;
        int pokedexNumber = 0;

        while (pokedexNumber < 1017)
        {
            IEnumerable<Pokemon> pokemonList = await pokeApiService.GetPokemonListAsync(20, pokedexNumber);
            await localPokemonData.CreateMultipleLocalPokemonsAsync(pokemonList);
            pokedexNumber += 20;
        }
        

        showLoadingArt = false;
        StateHasChanged();
    }
}